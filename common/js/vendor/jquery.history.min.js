(function(e){function r(n){function r(e){if(e===true){return function(e){return e}}if(typeof e=="string"&&(e=i(e.split("")))||typeof e=="function"){return function(t){return e(encodeURIComponent(t))}}return encodeURIComponent}function i(t){var n=new RegExp(e.map(t,encodeURIComponent).join("|"),"ig");return function(e){return e.replace(n,decodeURIComponent)}}n=e.extend({unescape:false},n||{});t.encoder=r(n.unescape)}var t={put:function(e,t){(t||window).location.hash=this.encoder(e)},get:function(t){var n=(t||window).location.hash.replace(/^#/,"");try{return e.browser.mozilla?n:decodeURIComponent(n)}catch(r){return n}},encoder:encodeURIComponent};var n={id:"__jQuery_history",init:function(){var t='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';e("body").prepend(t);return this},_document:function(){return e("#"+this.id)[0].contentWindow.document},put:function(e){var n=this._document();n.open();n.close();t.put(e,n)},get:function(){return t.get(this._document())}};var i={};i.base={callback:undefined,type:undefined,check:function(){},load:function(e){},init:function(e,t){r(t);s.callback=e;s._options=t;s._init()},_init:function(){},_options:{}};i.timer={_appState:undefined,_init:function(){var e=t.get();s._appState=e;s.callback(e);setInterval(s.check,100)},check:function(){var e=t.get();if(e!=s._appState){s._appState=e;s.callback(e)}},load:function(e){if(e!=s._appState){t.put(e);s._appState=e;s.callback(e)}}};i.iframeTimer={_appState:undefined,_init:function(){var e=t.get();s._appState=e;n.init().put(e);s.callback(e);setInterval(s.check,100)},check:function(){var e=n.get(),r=t.get();if(r!=e){if(r==s._appState){s._appState=e;t.put(e);s.callback(e)}else{s._appState=r;n.put(r);s.callback(r)}}},load:function(e){if(e!=s._appState){t.put(e);n.put(e);s._appState=e;s.callback(e)}}};i.hashchangeEvent={_init:function(){s.callback(t.get());e(window).bind("hashchange",s.check)},check:function(){s.callback(t.get())},load:function(e){t.put(e)}};var s=e.extend({},i.base);if(e.browser.msie&&(e.browser.version<8||document.documentMode<8)){s.type="iframeTimer"}else if("onhashchange"in window){s.type="hashchangeEvent"}else{s.type="timer"}e.extend(s,i[s.type]);e.history=s})(jQuery)